(function(a){a.fn.extend({tableExport:function(L){var T={consoleLog:false,csvEnclosure:'"',csvSeparator:",",csvUseBOM:true,displayTableName:false,escape:false,excelstyles:[],fileName:"tableExport",htmlContent:false,ignoreColumn:[],ignoreRow:[],jsonScope:"all",jspdf:{orientation:"p",unit:"pt",format:"a4",margins:{left:20,right:10,top:10,bottom:10},autotable:{styles:{cellPadding:2,rowHeight:12,fontSize:8,fillColor:255,textColor:50,fontStyle:"normal",overflow:"ellipsize",halign:"left",valign:"middle"},headerStyles:{fillColor:[52,73,94],textColor:255,fontStyle:"bold",halign:"center"},alternateRowStyles:{fillColor:245},tableExport:{onAfterAutotable:null,onBeforeAutotable:null,onTable:null}}},numbers:{html:{decimalMark:".",thousandsSeparator:","},output:{decimalMark:".",thousandsSeparator:","}},onCellData:null,onCellHtmlData:null,outputMode:"file",tbodySelector:"tr",theadSelector:"tr",tableName:"myTableName",type:"csv",worksheetName:"xlsWorksheetName"};var h=1.15;var ac=this;var E=null;var d=[];var g=[];var b=0;var Z=[];var J="";var H=[];a.extend(true,T,L);H=w(ac);if(T.type=="csv"||T.type=="txt"){var k="";var ad=0;b=0;function x(ah,aj,e,ai){g=a(ac).find(ah).first().find(aj);g.each(function(){J="";G(this,e,b,ai+g.length,function(ak,am,al){J+=r(ak,am,al)+T.csvSeparator});J=a.trim(J).substring(0,J.length-1);if(J.length>0){if(k.length>0){k+="\n"}k+=J}b++});return g.length}ad+=x("thead",T.theadSelector,"th,td",ad);ad+=x("tbody",T.tbodySelector,"td",ad);x("tfoot",T.tbodySelector,"td",ad);k+="\n";if(T.consoleLog===true){console.log(k)}if(T.outputMode==="string"){return k}if(T.outputMode==="base64"){return M(k)}try{var K=new Blob([k],{type:"text/"+(T.type=="csv"?"csv":"plain")+";charset=utf-8"});saveAs(K,T.fileName+"."+T.type,(T.type!="csv"||T.csvUseBOM===false))}catch(ae){Q(T.fileName+"."+T.type,"data:text/"+(T.type=="csv"?"csv":"plain")+";charset=utf-8,"+((T.type=="csv"&&T.csvUseBOM)?"\ufeff":""),k)}}else{if(T.type=="sql"){b=0;var y="INSERT INTO `"+T.tableName+"` (";d=a(ac).find("thead").first().find(T.theadSelector);d.each(function(){G(this,"th,td",b,d.length,function(e,ai,ah){y+="'"+R(e,ai,ah)+"',"});b++;y=a.trim(y);y=a.trim(y).substring(0,y.length-1)});y+=") VALUES ";g=a(ac).find("tbody").first().find(T.tbodySelector);g.each(function(){J="";G(this,"td",b,d.length+g.length,function(e,ai,ah){J+="'"+R(e,ai,ah)+"',"});if(J.length>3){y+="("+J;y=a.trim(y).substring(0,y.length-1);y+="),"}b++});y=a.trim(y).substring(0,y.length-1);y+=";";if(T.consoleLog===true){console.log(y)}if(T.outputMode==="string"){return y}if(T.outputMode==="base64"){return M(y)}try{var K=new Blob([y],{type:"text/plain;charset=utf-8"});saveAs(K,T.fileName+".sql")}catch(ae){Q(T.fileName+".sql","data:application/sql;charset=utf-8,",y)}}else{if(T.type=="json"){var B=[];d=a(ac).find("thead").first().find(T.theadSelector);d.each(function(){var e=[];G(this,"th,td",b,d.length,function(ah,aj,ai){e.push(R(ah,aj,ai))});B.push(e)});var i=[];g=a(ac).find("tbody").first().find(T.tbodySelector);g.each(function(){var ah={};var e=0;G(this,"td",b,d.length+g.length,function(ai,ak,aj){if(B.length){ah[B[B.length-1][e]]=R(ai,ak,aj)}else{ah[e]=R(ai,ak,aj)}e++});if(a.isEmptyObject(ah)==false){i.push(ah)}b++});var I="";if(T.jsonScope=="head"){I=JSON.stringify(B)}else{if(T.jsonScope=="data"){I=JSON.stringify(i)}else{I=JSON.stringify({header:B,data:i})}}if(T.consoleLog===true){console.log(I)}if(T.outputMode==="string"){return I}if(T.outputMode==="base64"){return M(I)}try{var K=new Blob([I],{type:"application/json;charset=utf-8"});saveAs(K,T.fileName+".json")}catch(ae){Q(T.fileName+".json","data:application/json;charset=utf-8;base64,",I)}}else{if(T.type==="xml"){b=0;var D='<?xml version="1.0" encoding="utf-8"?>';D+="<tabledata><fields>";d=a(ac).find("thead").first().find(T.theadSelector);d.each(function(){G(this,"th,td",b,g.length,function(e,ai,ah){D+="<field>"+R(e,ai,ah)+"</field>"});b++});D+="</fields><data>";var q=1;g=a(ac).find("tbody").first().find(T.tbodySelector);g.each(function(){var e=1;J="";G(this,"td",b,d.length+g.length,function(ah,aj,ai){J+="<column-"+e+">"+R(ah,aj,ai)+"</column-"+e+">";e++});if(J.length>0&&J!="<column-1></column-1>"){D+='<row id="'+q+'">'+J+"</row>";q++}b++});D+="</data></tabledata>";if(T.consoleLog===true){console.log(D)}if(T.outputMode==="string"){return D}if(T.outputMode==="base64"){return M(D)}try{var K=new Blob([D],{type:"application/xml;charset=utf-8"});saveAs(K,T.fileName+".xml")}catch(ae){Q(T.fileName+".xml","data:application/xml;charset=utf-8;base64,",D)}}else{if(T.type=="excel"||T.type=="xls"||T.type=="word"||T.type=="doc"){var N=(T.type=="excel"||T.type=="xls")?"excel":"word";var s=(N=="excel")?"xls":"doc";var ab=(s=="xls")?'xmlns:x="urn:schemas-microsoft-com:office:excel"':'xmlns:w="urn:schemas-microsoft-com:office:word"';var af=a(ac).filter(function(){return a(this).data("tableexport-display")!="none"&&(a(this).is(":visible")||a(this).data("tableexport-display")=="always")});var u="";af.each(function(){b=0;H=w(this);u+="<table><thead>";d=a(this).find("thead").first().find(T.theadSelector);d.each(function(){J="";G(this,"th,td",b,d.length,function(ah,al,aj){if(ah!=null){var e="";J+="<th";for(var ak in T.excelstyles){if(T.excelstyles.hasOwnProperty(ak)){var ai=a(ah).css(T.excelstyles[ak]);if(ai!=""&&ai!="0px none rgb(0, 0, 0)"){if(e==""){e='style="'}e+=T.excelstyles[ak]+":"+ai+";"}}}if(e!=""){J+=" "+e+'"'}if(a(ah).is("[colspan]")){J+=' colspan="'+a(ah).attr("colspan")+'"'}if(a(ah).is("[rowspan]")){J+=' rowspan="'+a(ah).attr("rowspan")+'"'}J+=">"+R(ah,al,aj)+"</th>"}});if(J.length>0){u+="<tr>"+J+"</tr>"}b++});u+="</thead><tbody>";g=a(this).find("tbody").first().find(T.tbodySelector);g.each(function(){J="";G(this,"td",b,d.length+g.length,function(e,al,ah){if(e!=null){var aj="";var ai=a(e).data("tableexport-msonumberformat");if(typeof ai=="undefined"&&typeof T.onMsoNumberFormat==="function"){ai=T.onMsoNumberFormat(e,al,ah)}if(typeof ai!="undefined"&&ai!=""){if(aj==""){aj='style="'}aj='style="mso-number-format:'+ai+";"}J+="<td";for(var ak in T.excelstyles){if(T.excelstyles.hasOwnProperty(ak)){ai=a(e).css(T.excelstyles[ak]);if(ai!=""&&ai!="0px none rgb(0, 0, 0)"){if(aj==""){aj='style="'}aj+=T.excelstyles[ak]+":"+ai+";"}}}if(aj!=""){J+=" "+aj+'"'}if(a(e).is("[colspan]")){J+=' colspan="'+a(e).attr("colspan")+'"'}if(a(e).is("[rowspan]")){J+=' rowspan="'+a(e).attr("rowspan")+'"'}J+=">"+R(e,al,ah)+"</td>"}});if(J.length>0){u+="<tr>"+J+"</tr>"}b++});if(T.displayTableName){u+="<tr><td></td></tr><tr><td></td></tr><tr><td>"+R(a("<p>"+T.tableName+"</p>"))+"</td></tr>"}u+="</tbody></table>";if(T.consoleLog===true){console.log(u)}});var V='<html xmlns:o="urn:schemas-microsoft-com:office:office" '+ab+' xmlns="http://www.w3.org/TR/REC-html40">';V+='<meta http-equiv="content-type" content="application/vnd.ms-'+N+'; charset=UTF-8">';V+="<head>";if(N==="excel"){V+="<!--[if gte mso 9]>";V+="<xml>";V+="<x:ExcelWorkbook>";V+="<x:ExcelWorksheets>";V+="<x:ExcelWorksheet>";V+="<x:Name>";V+=T.worksheetName;V+="</x:Name>";V+="<x:WorksheetOptions>";V+="<x:DisplayGridlines/>";V+="</x:WorksheetOptions>";V+="</x:ExcelWorksheet>";V+="</x:ExcelWorksheets>";V+="</x:ExcelWorkbook>";V+="</xml>";V+="<![endif]-->"}V+="</head>";V+="<body>";V+=u;V+="</body>";V+="</html>";if(T.consoleLog===true){console.log(V)}if(T.outputMode==="string"){return V}if(T.outputMode==="base64"){return M(V)}try{var K=new Blob([V],{type:"application/vnd.ms-"+T.type});saveAs(K,T.fileName+"."+s)}catch(ae){Q(T.fileName+"."+s,"data:application/vnd.ms-"+N+";base64,",V)}}else{if(T.type=="png"){html2canvas(a(ac)[0],{allowTaint:true,background:"#fff",onrendered:function(aj){var am=aj.toDataURL();am=am.substring(22);var ao=atob(am);var ah=new ArrayBuffer(ao.length);var an=new Uint8Array(ah);for(var ak=0;ak<ao.length;ak++){an[ak]=ao.charCodeAt(ak)}if(T.consoleLog===true){console.log(ao)}if(T.outputMode==="string"){return ao}if(T.outputMode==="base64"){return M(am)}try{var ai=new Blob([ah],{type:"image/png"});saveAs(ai,T.fileName+".png")}catch(al){Q(T.fileName+".png","data:image/png;base64,",am)}}})}else{if(T.type=="pdf"){if(T.jspdf.autotable===false){var O={dim:{w:z(a(ac).first().get(0),"width","mm"),h:z(a(ac).first().get(0),"height","mm")},pagesplit:false};var m=new jsPDF(T.jspdf.orientation,T.jspdf.unit,T.jspdf.format);m.addHTML(a(ac).first(),T.jspdf.margins.left,T.jspdf.margins.top,O,function(){A(m)})}else{var W=T.jspdf.autotable.tableExport;if(typeof T.jspdf.format==="string"&&T.jspdf.format.toLowerCase()==="bestfit"){var P={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89]};var U="",S="";var p=0;a(ac).filter(":visible").each(function(){if(a(this).css("display")!="none"){var e=z(a(this).get(0),"width","pt");if(e>p){if(e>P.a0[0]){U="a0";S="l"}for(var ah in P){if(P.hasOwnProperty(ah)){if(P[ah][1]>e){U=ah;S="l";if(P[ah][0]>e){S="p"}}}}p=e}}});T.jspdf.format=(U==""?"a4":U);T.jspdf.orientation=(S==""?"w":S)}W.doc=new jsPDF(T.jspdf.orientation,T.jspdf.unit,T.jspdf.format);a(ac).filter(function(){return a(this).data("tableexport-display")!="none"&&(a(this).is(":visible")||a(this).data("tableexport-display")=="always")}).each(function(){var ai;var aj=0;H=w(this);W.columns=[];W.rows=[];W.rowoptions={};if(typeof W.onTable==="function"){if(W.onTable(a(this),T)===false){return true}}T.jspdf.autotable.tableExport=null;var e=a.extend(true,{},T.jspdf.autotable);T.jspdf.autotable.tableExport=W;e.margin={};a.extend(true,e.margin,T.jspdf.margins);e.tableExport=W;if(typeof e.beforePageContent!=="function"){e.beforePageContent=function(al){if(al.pageCount==1){var ak=al.table.rows.concat(al.table.headerRow);ak.forEach(function(am){if(am.height>0){am.height+=(2-h)/2*am.styles.fontSize;al.table.height+=(2-h)/2*am.styles.fontSize}})}}}if(typeof e.createdHeaderCell!=="function"){e.createdHeaderCell=function(ak,an){ak.styles=a.extend({},an.row.styles);if(typeof W.columns[an.column.dataKey]!="undefined"){var am=W.columns[an.column.dataKey];if(typeof am.rect!="undefined"){var al;ak.contentWidth=am.rect.width;if(typeof W.heightRatio=="undefined"||W.heightRatio==0){if(an.row.raw[an.column.dataKey].rowspan){al=an.row.raw[an.column.dataKey].rect.height/an.row.raw[an.column.dataKey].rowspan}else{al=an.row.raw[an.column.dataKey].rect.height}W.heightRatio=ak.styles.rowHeight/al}al=an.row.raw[an.column.dataKey].rect.height*W.heightRatio;if(al>ak.styles.rowHeight){ak.styles.rowHeight=al}}if(typeof am.style!="undefined"&&am.style.hidden!==true){ak.styles.halign=am.style.align;if(e.styles.fillColor==="inherit"){ak.styles.fillColor=am.style.bcolor}if(e.styles.textColor==="inherit"){ak.styles.textColor=am.style.color}if(e.styles.fontStyle==="inherit"){ak.styles.fontStyle=am.style.fstyle}}}}}if(typeof e.createdCell!=="function"){e.createdCell=function(ak,am){var al=W.rowoptions[am.row.index+":"+am.column.dataKey];if(typeof al!="undefined"&&typeof al.style!="undefined"&&al.style.hidden!==true){ak.styles.halign=al.style.align;if(e.styles.fillColor==="inherit"){ak.styles.fillColor=al.style.bcolor}if(e.styles.textColor==="inherit"){ak.styles.textColor=al.style.color}if(e.styles.fontStyle==="inherit"){ak.styles.fontStyle=al.style.fstyle}}}}if(typeof e.drawHeaderCell!=="function"){e.drawHeaderCell=function(ak,am){var al=W.columns[am.column.dataKey];if((al.style.hasOwnProperty("hidden")!=true||al.style.hidden!==true)&&al.rowIndex>=0){return aa(ak,am,al)}else{return false}}}if(typeof e.drawCell!=="function"){e.drawCell=function(ak,an){var al=W.rowoptions[an.row.index+":"+an.column.dataKey];if(aa(ak,an,al)){W.doc.rect(ak.x,ak.y,ak.width,ak.height,ak.styles.fillStyle);if(typeof al!="undefined"&&typeof al.kids!="undefined"&&al.kids.length>0){var am=ak.height/al.rect.height;if(am>W.dh||typeof W.dh=="undefined"){W.dh=am}W.dw=ak.width/al.rect.width;t(ak,al.kids,W)}W.doc.autoTableText(ak.text,ak.textPos.x,ak.textPos.y,{halign:ak.styles.halign,valign:ak.styles.valign})}return false}}W.headerrows=[];d=a(this).find("thead").find(T.theadSelector);d.each(function(){ai=0;W.headerrows[aj]=[];G(this,"th,td",aj,d.length,function(ak,an,al){var am=f(ak);am.title=R(ak,an,al);am.key=ai++;am.rowIndex=aj;W.headerrows[aj].push(am)});aj++});if(aj>0){a.each(W.headerrows[aj-1],function(){if(aj>1&&this.rect==null){obj=W.headerrows[aj-2][this.key]}else{obj=this}if(obj!=null){W.columns.push(obj)}})}var ah=0;g=a(this).find("tbody").find(T.tbodySelector);g.each(function(){var ak=[];ai=0;G(this,"td",aj,d.length+g.length,function(al,ao,am){if(typeof W.columns[ai]==="undefined"){var an={title:"",key:ai,style:{hidden:true}};W.columns.push(an)}if(typeof al!=="undefined"&&al!=null){var an=f(al);an.kids=a(al).children();W.rowoptions[ah+":"+ai++]=an}else{var an=a.extend(true,{},W.rowoptions[ah+":"+(ai-1)]);an.colspan=-1;W.rowoptions[ah+":"+ai++]=an}ak.push(R(al,ao,am))});if(ak.length){W.rows.push(ak);ah++}aj++});if(typeof W.onBeforeAutotable==="function"){W.onBeforeAutotable(a(this),W.columns,W.rows,e)}W.doc.autoTable(W.columns,W.rows,e);if(typeof W.onAfterAutotable==="function"){W.onAfterAutotable(a(this),e)}T.jspdf.autotable.startY=W.doc.autoTableEndPosY()+e.margin.top});A(W.doc);if(typeof W.headerrows!="undefined"){W.headerrows.length=0}if(typeof W.columns!="undefined"){W.columns.length=0}if(typeof W.rows!="undefined"){W.rows.length=0}delete W.doc;W.doc=null}}}}}}}}function o(ai,ah,aj){var e=null;a.each(ai,function(){if(this.rowIndex==aj&&this.key==ah){e=this;return false}});return e}function w(ah){var e=[];a(ah).find("thead").first().find("th").each(function(ai,aj){if(a(aj).attr("data-field")!==undefined){e[ai]=a(aj).attr("data-field")}else{e[ai]=ai.toString()}});return e}function ag(ah,ai){var e=false;if(T.ignoreColumn.length>0){if(typeof T.ignoreColumn[0]=="string"){if(H.length>ai&&typeof H[ai]!="undefined"){if(a.inArray(H[ai],T.ignoreColumn)!=-1){e=true}}}else{if(typeof T.ignoreColumn[0]=="number"){if(a.inArray(ai,T.ignoreColumn)!=-1||a.inArray(ai-ah.length,T.ignoreColumn)!=-1){e=true}}}}return e}function G(ai,ah,an,ak,am){if(a.inArray(an,T.ignoreRow)==-1&&a.inArray(an-ak,T.ignoreRow)==-1){var e=a(ai).filter(function(){return a(this).data("tableexport-display")!="none"&&(a(this).is(":visible")||a(this).data("tableexport-display")=="always"||a(this).closest("table").data("tableexport-display")=="always")}).find(ah);var aj=0;var al=0;e.each(function(ao){if(a(this).data("tableexport-display")=="always"||(a(this).css("display")!="none"&&a(this).css("visibility")!="hidden"&&a(this).data("tableexport-display")!="none")){if(ag(e,ao)==false){if(typeof(am)==="function"){var at,ar=0;var aq,ap=0;if(typeof Z[an]!="undefined"&&Z[an].length>0){for(at=0;at<=ao;at++){if(typeof Z[an][at]!="undefined"){am(null,an,at);delete Z[an][at];ao++}}}al=ao;if(a(this).is("[colspan]")){ar=parseInt(a(this).attr("colspan"));aj+=ar>0?ar-1:0}if(a(this).is("[rowspan]")){ap=parseInt(a(this).attr("rowspan"))}am(this,an,ao);for(at=0;at<ar-1;at++){am(null,an,ao+at)}if(ap){for(aq=1;aq<ap;aq++){if(typeof Z[an+aq]=="undefined"){Z[an+aq]=[]}Z[an+aq][ao+aj]="";for(at=1;at<ar;at++){Z[an+aq][ao+aj-at]=""}}}}}}});if(typeof Z[an]!="undefined"&&Z[an].length>0){for(c=0;c<=Z[an].length;c++){if(typeof Z[an][c]!="undefined"){am(null,an,c);delete Z[an][c]}}}}}function A(aj){if(T.consoleLog===true){console.log(aj.output())}if(T.outputMode==="string"){return aj.output()}if(T.outputMode==="base64"){return M(aj.output())}try{var ah=aj.output("blob");saveAs(ah,T.fileName+".pdf")}catch(ai){Q(T.fileName+".pdf","data:application/pdf;base64,",aj.output())}}function aa(ao,ak,aj){var am=0;if(typeof aj!="undefined"){am=aj.colspan}if(am>=0){var ah=ao.width;var e=ao.textPos.x;var al=ak.table.columns.indexOf(ak.column);for(var an=1;an<am;an++){var ai=ak.table.columns[al+an];ah+=ai.width}if(am>1){if(ao.styles.halign==="right"){e=ao.textPos.x+ah-ao.width}else{if(ao.styles.halign==="center"){e=ao.textPos.x+(ah-ao.width)/2}}}ao.width=ah;ao.textPos.x=e;if(typeof aj!="undefined"&&aj.rowspan>1){ao.height=ao.height*aj.rowspan}if(ao.styles.valign==="middle"||ao.styles.valign==="bottom"){var aq=typeof ao.text==="string"?ao.text.split(/\r\n|\r|\n/g):ao.text;var ap=aq.length||1;if(ap>2){ao.textPos.y-=((2-h)/2*ak.row.styles.fontSize)*(ap-2)/3}}return true}else{return false}}function t(e,ai,ah){ai.each(function(){var an=a(this).children();if(a(this).is("div")){var ap=Y(X(this,"background-color"),[255,255,255]);var aq=Y(X(this,"border-top-color"),[0,0,0]);var ao=z(this,"border-top-width",T.jspdf.unit);var aj=this.getBoundingClientRect();var al=this.offsetLeft*ah.dw;var ak=this.offsetTop*ah.dh;var am=aj.width*ah.dw;var ar=aj.height*ah.dh;ah.doc.setDrawColor.apply(undefined,aq);ah.doc.setFillColor.apply(undefined,ap);ah.doc.setLineWidth(ao);ah.doc.rect(e.x+al,e.y+ak,am,ar,ao?"FD":"F")}if(typeof an!="undefined"&&an.length>0){t(e,an,ah)}})}function l(e){return e.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function v(e,ai,ah){return e.replace(new RegExp(l(ai),"g"),ah)}function r(ah,al,ai){var e="";if(ah!=null){var aj=R(ah,al,ai);var ak=(aj===null||aj=="")?"":aj.toString();if(aj instanceof Date){e=T.csvEnclosure+aj.toLocaleString()+T.csvEnclosure}else{e=v(ak,T.csvEnclosure,T.csvEnclosure+T.csvEnclosure);if(e.indexOf(T.csvSeparator)>=0||/[\r\n ]/g.test(e)){e=T.csvEnclosure+e+T.csvEnclosure}}}return e}function C(e){e=e||"0";e=v(e,T.numbers.html.decimalMark,".");e=v(e,T.numbers.html.thousandsSeparator,"");return typeof e==="number"||jQuery.isNumeric(e)!==false?e:false}function R(an,ak,am){var aq="";if(an!=null){var al=a(an);var ap;if(al[0].hasAttribute("data-tableexport-value")){ap=al.data("tableexport-value")}else{ap=al.html()}if(typeof T.onCellHtmlData==="function"){ap=T.onCellHtmlData(al,ak,am,ap)}if(T.htmlContent===true){aq=a.trim(ap)}else{var ao=ap.replace(/\n/g,"\u2028").replace(/<br\s*[\/]?>/gi,"\u2060");var ai=a("<div/>").html(ao).contents();ao="";a.each(ai.text().split("\u2028"),function(at,ar){if(at>0){ao+=" "}ao+=a.trim(ar)});a.each(ao.split("\u2060"),function(at,ar){if(at>0){aq+="\n"}aq+=a.trim(ar).replace(/\u00AD/g,"")});if(T.numbers.html.decimalMark!=T.numbers.output.decimalMark||T.numbers.html.thousandsSeparator!=T.numbers.output.thousandsSeparator){var ah=C(aq);if(ah!==false){var e=(""+ah).split(".");if(e.length==1){e[1]=""}var aj=e[0].length>3?e[0].length%3:0;aq=(ah<0?"-":"")+(T.numbers.output.thousandsSeparator?((aj?e[0].substr(0,aj)+T.numbers.output.thousandsSeparator:"")+e[0].substr(aj).replace(/(\d{3})(?=\d)/g,"$1"+T.numbers.output.thousandsSeparator)):e[0])+(e[1].length?T.numbers.output.decimalMark+e[1]:"")}}}if(T.escape===true){aq=escape(aq)}if(typeof T.onCellData==="function"){aq=T.onCellData(al,ak,am,aq)}}return aq}function j(ah,e,ai){return e+"-"+ai.toLowerCase()}function Y(aj,ah){var ai=/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/;var ak=ai.exec(aj);var e=ah;if(ak){e=[parseInt(ak[1]),parseInt(ak[2]),parseInt(ak[3])]}return e}function f(ai){var aj=X(ai,"text-align");var am=X(ai,"font-weight");var ah=X(ai,"font-style");var al="";if(aj=="start"){aj=X(ai,"direction")=="rtl"?"right":"left"}if(am>=700){al="bold"}if(ah=="italic"){al+=ah}if(al==""){al="normal"}var e={style:{align:aj,bcolor:Y(X(ai,"background-color"),[255,255,255]),color:Y(X(ai,"color"),[0,0,0]),fstyle:al},colspan:(parseInt(a(ai).attr("colspan"))||0),rowspan:(parseInt(a(ai).attr("rowspan"))||0)};if(ai!==null){var ak=ai.getBoundingClientRect();e.rect={width:ak.width,height:ak.height}}return e}function X(ai,aj){try{if(window.getComputedStyle){aj=aj.replace(/([a-z])([A-Z])/,j);return window.getComputedStyle(ai,null).getPropertyValue(aj)}if(ai.currentStyle){return ai.currentStyle[aj]}return ai.style[aj]}catch(ah){}return""}function n(ai,al,ak){var aj=100;var e=document.createElement("div");e.style.overflow="hidden";e.style.visibility="hidden";ai.appendChild(e);e.style.width=aj+ak;var ah=aj/e.offsetWidth;ai.removeChild(e);return(al*ah)}function z(aj,ak,ah){var ai=X(aj,ak);var e=ai.match(/\d+/);if(e!==null){e=e[0];return n(aj.parentElement,e,ah)}return 0}function Q(ah,al,aj){var ai=window.navigator.userAgent;if(ai.indexOf("MSIE ")>0||!!ai.match(/Trident.*rv\:11\./)){var ak=document.createElement("iframe");if(ak){document.body.appendChild(ak);ak.setAttribute("style","display:none");ak.contentDocument.open("txt/html","replace");ak.contentDocument.write(aj);ak.contentDocument.close();ak.focus();ak.contentDocument.execCommand("SaveAs",true,ah);document.body.removeChild(ak)}}else{var e=document.createElement("a");if(e){e.style.display="none";e.download=ah;if(al.toLowerCase().indexOf("base64,")>=0){e.href=al+M(aj)}else{e.href=al+encodeURIComponent(aj)}document.body.appendChild(e);if(document.createEvent){if(E==null){E=document.createEvent("MouseEvents")}E.initEvent("click",true,false);e.dispatchEvent(E)}else{if(document.createEventObject){e.fireEvent("onclick")}else{if(typeof e.onclick=="function"){e.onclick()}}}document.body.removeChild(e)}}}function F(ah){ah=ah.replace(/\x0d\x0a/g,"\x0a");var e="";for(var aj=0;aj<ah.length;aj++){var ai=ah.charCodeAt(aj);if(ai<128){e+=String.fromCharCode(ai)}else{if((ai>127)&&(ai<2048)){e+=String.fromCharCode((ai>>6)|192);e+=String.fromCharCode((ai&63)|128)}else{e+=String.fromCharCode((ai>>12)|224);e+=String.fromCharCode(((ai>>6)&63)|128);e+=String.fromCharCode((ai&63)|128)}}}return e}function M(aj){var ah="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var e="";var aq,ao,am,ap,an,al,ak;var ai=0;aj=F(aj);while(ai<aj.length){aq=aj.charCodeAt(ai++);ao=aj.charCodeAt(ai++);am=aj.charCodeAt(ai++);ap=aq>>2;an=((aq&3)<<4)|(ao>>4);al=((ao&15)<<2)|(am>>6);ak=am&63;if(isNaN(ao)){al=ak=64}else{if(isNaN(am)){ak=64}}e=e+ah.charAt(ap)+ah.charAt(an)+ah.charAt(al)+ah.charAt(ak)}return e}return this}})})(jQuery);